---
title: "W241 Final Project - Main Script"
author: "Fisher Kim, Kai Ying, Lucas Schroyer, Peter YH Kim"
date: '2022-04-03'
output:
  pdf_document: default
  word_document: default
---

## Introduction

This is the markdown script for a final project for the UC Berkeley School of Information - W241.


## Configurations and Load Packages
```{r global options, include = FALSE}
knitr::opts_chunk$set(include = FALSE, message = FALSE, warning = FALSE )

knitr::knit_engines$set(problem_description = function(options) {
  code <- paste(options$code, collapse = "\n")
})

```

```{r load packages, message = FALSE}
library(data.table)

if (!require("lmtest")) install.packages("lmtest")
if (!require("sandwich")) install.packages("sandwich")
if (!require("patchwork")) install.packages("patchwork")
if (!require("stargazer")) install.packages("stargazer")
if (!require("tidyverse")) install.packages("tidyverse")
if (!require("janitor")) install.packages("janitor")
if (!require("AER")) install.packages("AER")


library(sandwich)
library(lmtest)

library(AER) 

library(ggplot2) 
library(patchwork)

library(tidyverse)
library(janitor)


```
## Theory and Background 


## Load and Clean Data

You can also embed plots, for example:

```{r pressure, echo=FALSE}
d <- fread('../src/data/W241 Survey StoryTelling Experiment_April 3, 2022_20.19.csv')

# Transform Column Names
d <- janitor::clean_names(d)

# Create Column Dictionary
d_dict <- d[1:1,]
d <- d[3:nrow(d),] #if exporting a csv from Qualtrics, use third row. Excel is 2

# Drop unnecessary columns
d <- d[, alien_treatment_bool := ifelse(alien_control == "", 0, 1)]
d <- d[, recyc_treatment_bool := ifelse(recycle_control == "", 0, 1)]
d <- d[, social_treatment_bool := ifelse(control_social == "", 0, 1)]

d_2 <- d %>% 
  select(alien_treatment_bool, recyc_treatment_bool, social_treatment_bool, sc1, sc2, sc3) %>%
  gather(key = "treatment_question", value = "treatment_bool", alien_treatment_bool, recyc_treatment_bool, social_treatment_bool) %>% 
  gather(key = "quiz_question", value = "quiz_correct_num", sc1, sc2, sc3) %>% 
  mutate(quiz_perc_correct = as.double(quiz_correct_num)/4) %>% 
  as.data.table()


d_2 %>% head()
```



```{r regression}
model_basic <- d_2[, lm(quiz_perc_correct ~ treatment_bool)]

summary(model_basic)


```
